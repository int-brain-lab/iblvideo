version: "2.3"
services:
  dev-queue:
    image: internationalbrainlab/dlc:base
    command: python3 -c "from iblvideo import run_queue; run_queue()"
    runtime: nvidia
    volumes:
      - /datadisk/FlatIron:/datadisk/FlatIron
#      - /mnt/s0/Data/FlatIron:/mnt/s0/Data/FlatIron
      - ~/Documents/PYTHON/iblvideo:/root
  dev-test:
    image: internationalbrainlab/dlc:base
    command: bash -c "ls -l /root; nvcc --version; pytest /root/iblvideo/tests -log-cli-level=INFO"
    runtime: nvidia
    volumes:
#      - /mnt/s0/Data/FlatIron:/mnt/s0/Data/FlatIron
      - ~/Documents/PYTHON/iblvideo:/root
      - /datadisk/FlatIron:/datadisk/FlatIron
  queue:
    image: internationalbrainlab/dlc:v1.0
    command: python3 -c "from iblvideo import run_queue; run_queue()"
    runtime: nvidia
    volumes:
#      - /mnt/s0/Data/FlatIron:/mnt/s0/Data/FlatIron
      - /datadisk/FlatIron:/datadisk/FlatIron
  test:
    image: internationalbrainlab/dlc:v1.0
    command: bash -c "nvcc --version; pytest /iblvideo/iblvideo/tests"
    runtime: nvidia
